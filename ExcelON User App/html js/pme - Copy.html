<!doctype html>
<html lang="en">
<head>
    <title>Ebubekir Yapay Zeka</title>
    <meta name="viewport" content="width=device-width">
    <meta charset="utf-8">
</head>

<body>
    <div style="padding-top:15px" />
    <!--<input type="button" onclick="SavePDF()" value="Execute Sample" />-->
    <div id="myExcelDiv" style="width: 100%; height: 1000px"></div>
    <script type="text/javascript" src="https://onedrive.live.com/embed?resid=6B69B2943F1A08BE%21133&authkey=%21AEZQQJTkywy8W7c&em=3&wdDivId=%22myExcelDiv%22&&wdAllowTyping=1"></script>

    <script type="text/javascript">

        window.addEventListener('DOMContentLoaded', Page_Load, false);

        window.chrome.webview.addEventListener('message', msg => { HandelToolStripButton(msg) });

        function HandelToolStripButton(msg) {

            //if ("SetColor" in arg.data)
            //        arg.data.SetColor;

            switch (msg.data) {
                case 'PDF':
                    SavePDF();
                    break;
                case 'F5':
                    Refresh();
                    break;
                default:
                    alert("command not handeled");
            }
        }

        function Page_Load() {
            Ewa.EwaControl.add_applicationReady(GetEwa);
        }

        function GetEwa() {
            om = Ewa.EwaControl.getInstances().getItem(0);
        }

        function SavePDF() {

            //window.open(pdfurl, '_blank'); downlaod (open file in a new tab)
            window.chrome.webview.postMessage(om.getActiveWorkbook().getActiveSelection().getAddressA1());

            //range.getValuesAsync(0, getRangeValues, null);
        }

        function Refresh() {

            location.reload();
        }


    </script>

</body>

</html>